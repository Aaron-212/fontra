<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>Fontra</title>
    <style type="text/css">

      html, body {
        font-family: sans-serif;
        font-size: 0.95em;
        padding: 0;
        margin:  0;
        width: 100%;
        height: 100%;
        overflow: hidden; /* Hide scrollbars */
        white-space: nowrap;
        overscroll-behavior: none;
        touch-action: none;
      }

      .page {
        display: flex;
        height: 100%;
        flex-direction: row;
      }

      .controls {
        padding: 1em;
        background: lightgray;
        display: flex;
        flex-direction: column;
        gap: 0.5em;
      }

      .axis-sliders {
        display: flex;
        flex-direction: column;
        gap:  0.5em;
      }

      .slider-label {
      }

      .slider {
        margin: 0;
        padding: 0;
      }

      .canvas-container {
        width: 100%;
        height: 100%;
      }

      #edit-canvas {
        background: #222;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        overscroll-behavior: none;
        touch-action: none;
      }

    </style>
  </head>
  <body>
    <div class="page">

      <div class="controls">

        <select name="glyphs" id="glyph-select" oninput="glyphNameChanged(this.value)">
          <option value="">--Please choose a glyph--</option>
          <!-- contents will be filled dynamically -->
        </select>

        <div class="axis-sliders" id="axis-sliders">
          <!-- contents will be filled dynamically -->
        </div>

      </div>

      <div class="canvas-container">
        <canvas id="edit-canvas" tabindex="1"></canvas>
      </div>

  </div>
  </body>
    <script type="module">
      import { AppController } from "../src/app-controller.js";

      function httpGetAsync(theUrl, callback) {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = () => {
          if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
            callback(xmlHttp.responseText);
          }
        }
        xmlHttp.open("GET", theUrl, true); // true for asynchronous
        xmlHttp.send(null);
      }

      function startApp(port) {
        const appController = new AppController(port);
        window.glyphNameChanged = async (glyphName) => {
          await appController.glyphNameChangedCallback(glyphName);
        };
      }

      httpGetAsync("/websocketport", startApp)

    </script>
</html>
